@if (isReady()) {
  <div class="min-h-screen font-mono text-terminal-green p-4 boot-fade-in">
    <app-header [title]="title()" />

    <main class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      <!-- Bugs Delta Chart Panel -->
      <app-dashboard-panel [title]="chartState.bugsDeltaChart().options.title?.['en']">
        <app-date-level-toggle panel-actions chartKey="bugsDelta" />
        <app-luzmo-chart [chart]="chartState.bugsDeltaChart()" />
      </app-dashboard-panel>

      <!-- Open Bugs Evolution Chart Panel -->
      <app-dashboard-panel [title]="chartState.openBugsEvolutionChart().options.title?.['en']">
        <app-squad-filter-toggle panel-actions chartKey="openBugsEvolution" />
        <app-luzmo-chart [chart]="chartState.openBugsEvolutionChart()" />
      </app-dashboard-panel>

      <!-- Created Bugs Chart Panel -->
      <app-dashboard-panel [title]="chartState.createdBugsChart().options.title?.['en']">
        <app-date-level-toggle panel-actions chartKey="createdBugs" />
        <app-luzmo-chart [chart]="chartState.createdBugsChart()" />
      </app-dashboard-panel>

      <!-- Terminal Chat Panel -->
      <app-terminal-chat
        class="lg:col-span-3"
        [credentials]="embedAuth.credentials()"
        [apiUrl]="embedAuth.apiUrl"
        [appServer]="embedAuth.appServer"
        (chartGenerated)="chartState.addGeneratedChart($event)"
      />

      <!-- Open Bugs List Chart Panel -->
      <app-dashboard-panel [title]="chartState.openBugsListChart().options.title?.['en']">
        <app-squad-filter-toggle panel-actions chartKey="openBugsList" />
        <app-luzmo-chart [chart]="chartState.openBugsListChart()" />
      </app-dashboard-panel>

      <!-- PRs Merged By Squad Chart Panel -->
      <app-dashboard-panel [title]="chartState.prsMergedBySquadChart().options.title?.['en']">
        <app-pr-level-toggle panel-actions />
        <app-luzmo-chart [chart]="chartState.prsMergedBySquadChart()" />
      </app-dashboard-panel>

      <!-- PRs Per Repo Chart Panel -->
      <app-dashboard-panel [title]="chartState.prsPerRepoChart.options.title?.['en']">
        <app-luzmo-chart [chart]="chartState.prsPerRepoChart" />
      </app-dashboard-panel>
    </main>
  </div>
} @else {
  <div class="min-h-screen font-mono text-terminal-green p-4 flex items-center justify-center">
    @if (embedAuth.error()) {
      <div class="text-center">
        <p class="text-red-500 text-xl mb-2">Error loading credentials</p>
        <p class="text-red-400">{{ embedAuth.error() }}</p>
      </div>
    } @else {
      <!-- Boot sequence animation -->
      <div class="w-full max-w-2xl">
        <div class="border border-terminal-border bg-terminal-surface/30 shadow-[0_0_20px_rgba(0,255,65,0.12)] p-6">
          <div class="flex items-center gap-2 mb-4 pb-3 border-b border-terminal-border">
            <span class="w-2 h-2 rounded-full bg-alert-red"></span>
            <span class="w-2 h-2 rounded-full bg-warning-amber"></span>
            <span class="w-2 h-2 rounded-full bg-terminal-green"></span>
            <span class="text-xs text-terminal-dark ml-2 tracking-wider">SYSTEM_BOOT</span>
          </div>
          <div class="space-y-1.5 text-sm">
            @for (line of bootLines(); track $index) {
              <div class="boot-line flex gap-2">
                <span class="text-terminal-dark shrink-0">></span>
                <span [class]="$index === bootLines().length - 1 ? 'text-terminal-green' : 'text-terminal-muted'">
                  {{ line }}
                </span>
              </div>
            }
            @if (!bootTimerDone()) {
              <div class="flex gap-2">
                <span class="text-terminal-dark">></span>
                <span class="terminal-cursor text-terminal-green">_</span>
              </div>
            }
          </div>
        </div>
      </div>
    }
  </div>
}

<router-outlet />
